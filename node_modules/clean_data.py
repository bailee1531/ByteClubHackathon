import pandas as pd

weather_type = pd.read_csv('data\hunstville_0123_1224.csv')
huntsvilleWeather = pd.read_csv('data\huntsville_weather_data.csv')

huntsvilleWeather["DATE"] = pd.to_datetime(huntsvilleWeather["DATE_TIME"])
huntsvilleWeather["DATE"] = huntsvilleWeather["DATE"].dt.strftime('%m/%d/%Y')
dates = []
events = []

for i in range(len(weather_type["EVENT_TYPE"])):
    if weather_type["EVENT_TYPE"][i] == "Tornado" or weather_type["EVENT_TYPE"][i] == "Thunderstorm Wind" or weather_type["EVENT_TYPE"][i] == "Hail" or weather_type["EVENT_TYPE"][i] == "Flash Flood" or weather_type["EVENT_TYPE"][i] == "Funnel Cloud" or weather_type["EVENT_TYPE"][i] == "Flood" or weather_type["EVENT_TYPE"][i] == "Heavy Rain" or weather_type["EVENT_TYPE"][i] == "High Wind":
        dates.append(weather_type["BEGIN_DATE"][i])
        dates.append(weather_type["EVENT_TYPE"][i])

for i in range(1, len(huntsvilleWeather)):
    if huntsvilleWeather["DATE"][i] not in dates:
        huntsvilleWeather.drop(i, inplace=True)

for i in range(1, len(events)):
    huntsvilleWeather.at[i, "EVENT"] = events[i]

huntsvilleWeather.to_csv('data\huntsville_weather_data_cleaned.csv', index=False)